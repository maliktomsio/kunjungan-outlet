<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Sales Order Outlet</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
    font-family: -apple-system, BlinkMacSystemFont, Arial;
    background: #f4f6f9;
    margin: 0;
    padding: 15px;
}

.header {
    background: linear-gradient(135deg,#0f2a44,#123f66);
    color: white;
    padding: 25px;
    border-radius: 15px;
    text-align: center;
    margin-bottom: 20px;
}

.card {
    background: white;
    padding: 18px;
    border-radius: 15px;
    margin-bottom: 18px;
    box-shadow: 0 8px 20px rgba(0,0,0,.05);
}

label {
    font-weight: 600;
    margin-top: 10px;
    display: block;
}

input, select {
    width: 100%;
    padding: 12px;
    border-radius: 10px;
    border: 1px solid #ddd;
    margin-top: 5px;
}

button {
    width: 100%;
    padding: 14px;
    border: none;
    border-radius: 12px;
    font-size: 16px;
    margin-top: 15px;
    cursor: pointer;
}

.btn-add {
    background: #2563eb;
    color: white;
}

.btn-excel {
    background: #0f766e;
    color: white;
}

.btn-wa {
    background: #25D366;
    color: white;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
    font-size: 13px;
}

th, td {
    padding: 8px;
    border-bottom: 1px solid #eee;
}

th {
    background: #f1f5f9;
}

.hapus {
    background: #ef4444;
    color: white;
    padding: 6px 10px;
    border-radius: 8px;
    font-size: 12px;
}
</style>
</head>

<body>

<div class="header">
    <h2>ðŸ“¦ SALES ORDER</h2>
    <div>Rute Sebrang 1</div>
</div>

<div class="card">
<label>Tanggal</label>
<input type="date" id="tanggal">

<label>Outlet</label>
<select id="outlet">
<option value="">Pilih outlet</option>
<option>A088 â€“ AMELIA BAKEKO</option>
<option>A095 â€“ AMOR KIOS</option>
<option>A120 â€“ AGORA TIMUR NUSANTARA</option>
<option>A124 â€“ AZIZAH KIOS</option>
<option>A129 â€“ APRI KIOS SEBRANG</option>
<option>D029 â€“ DILA KIOS</option>
<option>D044 â€“ DILLA KIOS PASIR PANJANG</option>
<option>E004 â€“ EMMI TAN BU</option>
<option>H040 â€“ HENDRO KOLAM AIR BESAR</option>
<option>I042 â€“ IBU HASNI NASKUN</option>
<option>J012 â€“ JOKO MAS</option>
<option>K018 â€“ KODAR MAS</option>
<option>K055 â€“ KIOS IRMA</option>
<option>M085 â€“ MAULANA KIOS</option>
<option>N003 â€“ NANDO</option>
<option>P032 â€“ PUTRA SOLO</option>
<option>R038 â€“ RS MISI SEBRANG</option>
<option>S050 â€“ SUMBER REJEKI PASIR PANJANG</option>
<option>S076 â€“ SINAR MERAPI</option>
<option>S091 â€“ SINAR MUDA KIOS (EBA)</option>
<option>S092 â€“ KANTIN SMAN 2 (SLAMET)</option>
<option>S111 â€“ SABYAN KIOS</option>
<option>S160 â€“ SIMPANG TIGA KIOS</option>
<option>T002 â€“ ANTO KIOS</option>
<option>Y014 â€“ YULI BAKEKO</option>
<option>F002 â€“ FADJRIN</option>
<option>R024 â€“ ROMAIKA KIOS</option>
<option>S037 â€“ SOKIMIN SEBRANG</option>
<option>D010 â€“ DICKY SEBRANG</option>
<option>A111 â€“ ALKA KIOS</option>
<option>B064 â€“ BEACHES CAFE</option>
</select>

<label>Produk</label>
<input id="produk">

<label>Qty</label>
<input type="number" id="qty">

<label>Harga</label>
<input type="number" id="harga">

<button class="btn-add" onclick="tambah()">âž• Simpan Order</button>
</div>

<div class="card">
<button class="btn-excel" onclick="exportExcel()">â¬‡ Export Excel</button>
<button class="btn-wa" onclick="kirimWA()">ðŸ“² Kirim Laporan WhatsApp</button>

<table id="tabel"></table>
</div>

<script>
let data = JSON.parse(localStorage.getItem("order")) || [];

function render() {
    let html = `
    <tr>
    <th>Tgl</th><th>Outlet</th><th>Produk</th>
    <th>Qty</th><th>Total</th><th></th>
    </tr>`;

    data.forEach((d,i)=>{
        html += `
        <tr>
            <td>${d.tgl}</td>
            <td>${d.outlet}</td>
            <td>${d.produk}</td>
            <td>${d.qty}</td>
            <td>${d.total}</td>
            <td><button class="hapus" onclick="hapus(${i})">Hapus</button></td>
        </tr>`;
    });

    document.getElementById("tabel").innerHTML = html;
}

function tambah(){
    const tgl = tanggal.value;
    const outlet = document.getElementById("outlet").value;
    const produk = document.getElementById("produk").value;
    const qty = Number(document.getElementById("qty").value);
    const harga = Number(document.getElementById("harga").value);

    if(!tgl || !outlet || !produk) return alert("Lengkapi data");

    data.push({
        tgl, outlet, produk,
        qty, harga,
        total: qty * harga
    });

    localStorage.setItem("order",JSON.stringify(data));
    render();

    produk.value="";
    qty.value="";
    harga.value="";
}

function hapus(i){
    if(confirm("Hapus order ini?")){
        data.splice(i,1);
        localStorage.setItem("order",JSON.stringify(data));
        render();
    }
}

function exportExcel(){
    let csv = "Tanggal,Outlet,Produk,Qty,Harga,Total\n";
    data.forEach(d=>{
        csv+=`${d.tgl},${d.outlet},${d.produk},${d.qty},${d.harga},${d.total}\n`;
    });

    const blob=new Blob([csv],{type:"text/csv"});
    const a=document.createElement("a");
    a.href=URL.createObjectURL(blob);
    a.download="laporan-order.csv";
    a.click();
}

function kirimWA(){
    let text="*LAPORAN SALES ORDER*%0A%0A";
    let total=0;

    data.forEach(d=>{
        text+=`${d.tgl} - ${d.outlet}%0A`;
        text+=`${d.produk} x${d.qty} = ${d.total}%0A%0A`;
        total+=d.total;
    });

    text+=`*TOTAL: ${total}*`;

    window.open("https://wa.me/?text="+text);
}

render();
</script>

</body>
</html>
