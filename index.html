<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Sales App Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:system-ui;
  margin:0;
  background:#f1f5f9;
}
header{
  background:linear-gradient(135deg,#0f172a,#1e3a8a);
  color:white;
  padding:20px;
  border-radius:0 0 20px 20px;
}
.card{
  background:white;
  margin:12px;
  padding:14px;
  border-radius:16px;
}
select,input,button{
  width:100%;
  padding:12px;
  margin-top:6px;
  border-radius:12px;
  border:1px solid #ddd;
}
button{background:#2563eb;color:white;border:none}
.btn2{background:#059669}
.btn3{background:#25D366}
.btnDel{background:#ef4444}

.progress{
  background:#e2e8f0;
  border-radius:10px;
  margin-top:10px;
}
.bar{
  background:#2563eb;
  height:10px;
  border-radius:10px;
}

.visited{background:#dcfce7}
</style>
</head>

<body>

<header>
<h3>ðŸ“¦ SALES APP PRO</h3>
<div id="infoHari"></div>
</header>

<div class="card">
<label>Rute</label>
<select id="rute" onchange="loadOutlet()">
<option value="SEBRANG1">SEBRANG 1</option>
<option value="PASAR1">PASAR 1</option>
</select>

<label>Tanggal</label>
<input type="date" id="tgl">

<label>Outlet</label>
<select id="outlet"></select>

<label>Produk</label>
<select id="produk" onchange="isiHarga()"></select>

<input id="qty" type="number" placeholder="Qty">

<input id="harga" type="number" placeholder="Harga otomatis">

<button onclick="tambah()">âž• Simpan Order</button>

<button class="btn2" onclick="mulaiHari()">ðŸŒž Mulai Hari</button>
<button class="btn3" onclick="akhiriHari()">ðŸŒ™ Akhiri Hari</button>

<div id="progressText"></div>
<div class="progress"><div class="bar" id="bar"></div></div>
</div>

<div class="card">
<button class="btn2" onclick="exportExcel()">â¬‡ Export Excel</button>
<button class="btn3" onclick="kirimWA()">ðŸ“² Kirim WA</button>

<table id="tbl"></table>

<div id="total"></div>
</div>

<script>
// ===== DAFTAR PRODUK DARI FILE KAMU =====
const produkList = [
{nama:"FIBE MINI 24 X 110ML", harga:5775},
{nama:"ORONAMIN C DRINK BOTOL 24 X 120ML", harga:5250},
{nama:"POCARI SWEAT CAN 24 X 330ML", harga:4850},
{nama:"POCARI SWEAT ION WATER 24 X 350ML", harga:5250},
{nama:"POCARI SWEAT ION WATER 24 X 500ML", harga:6250},
{nama:"POCARI SWEAT PET 15 X 900ML", harga:10350},
{nama:"POCARI SWEAT PET 24 X 350ML", harga:5250},
{nama:"POCARI SWEAT PET 24 X 500ML", harga:6250},
{nama:"SOYJOY CHOCOLATE ALMOND", harga:8025},
{nama:"SOYJOY DANISH CHEESE", harga:8025}
];

// ===== RUTE OUTLET =====
const ruteData = {
SEBRANG1:[
"A088 â€“ AMELIA BAKEKO",
"A095 â€“ AMOR KIOS",
"A120 â€“ AGORA TIMUR NUSANTARA",
"A124 â€“ AZIZAH KIOS",
"A129 â€“ APRI KIOS SEBRANG",
"D029 â€“ DILA KIOS",
"B064 â€“ BEACHES CAFE"
],

PASAR1:[
"M077 MAMA PIPIN",
"W024 WA ODE MUTIARA BU",
"W034 WA ODE PASAR IKAN",
"S149 SCANVENGER",
"S110 SINAR ONING KIOS",
"L018 LA ARIFIN PURNAMA ILAHI",
"K052 WARUNG ES KASTIA",
"M111 MARDIAN"
]
};

let orders = JSON.parse(localStorage.getItem("orders"))||[];
let hariAktif = localStorage.getItem("hariAktif");

function isiProduk(){
produk.innerHTML="<option>Pilih Produk</option>";
produkList.forEach(p=>{
produk.innerHTML+=
`<option value="${p.nama}|${p.harga}">
${p.nama}</option>`;
});
}

function isiHarga(){
let v = produk.value.split("|");
harga.value = v[1];
}

function loadOutlet(){
let r = rute.value;
outlet.innerHTML="<option>Pilih Outlet</option>";

ruteData[r].forEach(o=>{
let s = orders.some(x=>x.tgl==tgl.value && x.outlet==o);
outlet.innerHTML+=
`<option class="${s?'visited':''}">
${o}${s?' âœ“':''}</option>`;
});

hitungProgress();
}

function tambah(){
orders.push({
tgl:tgl.value,
rute:rute.value,
outlet:outlet.value,
produk:produk.value.split("|")[0],
qty:+qty.value,
harga:+harga.value,
total:+qty.value * +harga.value
});

localStorage.setItem("orders",JSON.stringify(orders));
render();
loadOutlet();
}

function hitungProgress(){
let r=rute.value;
let total=ruteData[r].length;

let done = orders.filter(o=>
o.tgl==tgl.value && o.rute==r
).length;

progressText.innerText=`Progress: ${done} / ${total}`;

bar.style.width=(done/total*100)+"%";
}

function render(){
let h=`<tr>
<th>Tgl</th><th>Outlet</th>
<th>Produk</th><th>Total</th><th></th></tr>`;

let tot=0;

orders.forEach((o,i)=>{
h+=`<tr>
<td>${o.tgl}</td>
<td>${o.outlet}</td>
<td>${o.produk}</td>
<td>${o.total}</td>
<td><button class="btnDel" onclick="hapus(${i})">X</button></td>
</tr>`;
tot+=o.total;
});

tbl.innerHTML=h;
total.innerText="TOTAL Rp "+tot.toLocaleString();
}

function hapus(i){
orders.splice(i,1);
localStorage.setItem("orders",JSON.stringify(orders));
render();
loadOutlet();
}

function mulaiHari(){
localStorage.setItem("hariAktif",tgl.value);
infoHari.innerText="Hari Aktif: "+tgl.value;
}

function akhiriHari(){
if(confirm("Reset untuk hari baru?")){
orders=[];
localStorage.setItem("orders","[]");
render();
loadOutlet();
}
}

function exportExcel(){
let csv="tgl,outlet,produk,qty,harga,total\n";
orders.forEach(o=>{
csv+=`${o.tgl},${o.outlet},${o.produk},${o.qty},${o.harga},${o.total}\n`;
});

let a=document.createElement("a");
a.href=URL.createObjectURL(new Blob([csv]));
a.download="sales.csv";
a.click();
}

function kirimWA(){
let t="*LAPORAN SALES*\n\n";
orders.forEach(o=>{
t+=`${o.outlet}\n${o.produk} x${o.qty} = ${o.total}\n\n`;
});
window.open("https://wa.me/?text="+encodeURIComponent(t));
}

isiProduk();
render();
loadOutlet();
</script>

</body>
</html>
