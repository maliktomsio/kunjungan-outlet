<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Sales Order Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:system-ui;
  background:#f4f6f9;
  margin:0;
}
header{
  background:linear-gradient(135deg,#0f172a,#1e3a8a);
  color:white;
  padding:20px;
  text-align:center;
}
.card{
  background:white;
  margin:12px;
  padding:14px;
  border-radius:14px;
}
input,select{
  width:100%;
  padding:10px;
  margin-top:6px;
}
button{
  width:100%;
  padding:12px;
  margin-top:8px;
  border:none;
  border-radius:10px;
  background:#2563eb;
  color:white;
}
.btn2{background:#059669}
.btn3{background:#25D366}
table{
  width:100%;
  margin-top:10px;
  font-size:13px;
}
.total{
  background:#0f172a;
  color:white;
  padding:10px;
  text-align:center;
  margin-top:10px;
}
</style>
</head>

<body>

<header>
<h3>ðŸ“¦ SALES ORDER PRO</h3>
</header>

<div class="card">

<select id="produk" onchange="setHarga()">
<option value="">Pilih Produk</option>
</select>

<select id="satuan" onchange="setHarga()">
<option value="PCS">PCS</option>
<option value="KRT">KARTON</option>
</select>

<input id="qty" type="number" placeholder="Qty" oninput="hitung()">

<input id="harga" placeholder="Harga otomatis" readonly>

<input id="total" placeholder="Total" readonly>

<button onclick="tambah()">âž• Tambah</button>

</div>

<div class="card">
<button class="btn2" onclick="exportExcel()">â¬‡ Excel</button>
<button class="btn3" onclick="kirimWA()">ðŸ“² WA</button>

<table id="tbl"></table>

<div class="total" id="grand"></div>
</div>

<script>
// ==========================
// DATABASE PRODUK
// harga 1 PCS & isi per karton
// ==========================
const produkDB = [

{nama:"Mie Sedap Goreng", pcs:5250, isi:40},
{nama:"Mie Sedap Soto", pcs:5200, isi:40},
{nama:"Teh Pucuk 350ml", pcs:3200, isi:24},
{nama:"Aqua 600ml", pcs:3000, isi:24},
{nama:"Good Day", pcs:1800, isi:50},
{nama:"Roma Kelapa", pcs:9500, isi:20},
{nama:"Chiki Balls", pcs:2000, isi:60},
{nama:"Kopi Kapal Api", pcs:1500, isi:100}

];

let orders = JSON.parse(localStorage.getItem("orders")) || [];

// load produk
produkDB.forEach(p=>{
  produk.innerHTML += `<option>${p.nama}</option>`;
});

function setHarga(){

const p = produkDB.find(x=>x.nama==produk.value);
if(!p) return;

let h = 0;

if(satuan.value=="PCS"){
  h = p.pcs;
}else{
  h = p.pcs * p.isi;
}

harga.value = h;
hitung();
}

function hitung(){
total.value = qty.value * harga.value;
}

function tambah(){

if(!produk.value || !qty.value)
return alert("Lengkapi dulu");

orders.push({
produk:produk.value,
satuan:satuan.value,
qty:+qty.value,
harga:+harga.value,
total:+total.value
});

localStorage.setItem("orders",JSON.stringify(orders));

qty.value="";
render();
}

function render(){

let html=`<tr>
<th>Produk</th>
<th>Satuan</th>
<th>Qty</th>
<th>Total</th>
</tr>`;

let g=0;

orders.forEach(o=>{
html+=`<tr>
<td>${o.produk}</td>
<td>${o.satuan}</td>
<td>${o.qty}</td>
<td>${o.total}</td>
</tr>`;
g+=o.total;
});

tbl.innerHTML=html;
grand.innerText="TOTAL : Rp "+g.toLocaleString("id-ID");
}

// EXPORT
function exportExcel(){

let csv="Produk,Satuan,Qty,Harga,Total\n";

orders.forEach(o=>{
csv+=`${o.produk},${o.satuan},${o.qty},${o.harga},${o.total}\n`;
});

let a=document.createElement("a");
a.href=URL.createObjectURL(new Blob([csv]));
a.download="sales.csv";
a.click();
}

// WA
function kirimWA(){

let t="*ORDER*%0A%0A";
let g=0;

orders.forEach(o=>{
t+=`${o.produk}%0A${o.qty} ${o.satuan} = ${o.total}%0A%0A`;
g+=o.total;
});

t+="TOTAL : "+g;

window.open("https://wa.me/?text="+t);
}

render();
</script>

</body>
</html>
