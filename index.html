
<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Catatan Order Outlet</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
    font-family: Arial;
    background: #f2f2f2;
    padding: 15px;
}
h2 {
    text-align: center;
}
.box {
    background: #fff;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 15px;
}
label {
    font-weight: bold;
    display: block;
    margin-top: 10px;
}
input, select {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
}
button {
    margin-top: 15px;
    padding: 12px;
    width: 100%;
    background: #2196f3;
    color: #fff;
    border: none;
    border-radius: 8px;
    font-size: 16px;
}
table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
}
th, td {
    border: 1px solid #ccc;
    padding: 6px;
    font-size: 14px;
}
th {
    background: #eee;
}
</style>
</head>

<body>

<h2>ðŸ“¦ Catatan Order Outlet</h2>

<div class="box">

<label>Tanggal</label>
<input type="date" id="tanggal">

<label>Outlet</label>
<select id="outlet">
<option value="">-- pilih outlet --</option>
<option>A088 â€“ AMELIA BAKEKO</option>
<option>A095 â€“ AMOR KIOS</option>
<option>A120 â€“ AGORA TIMUR NUSANTARA</option>
<option>A124 â€“ AZIZAH KIOS</option>
<option>A129 â€“ APRI KIOS SEBRANG</option>
<option>D029 â€“ DILA KIOS</option>
<option>D044 â€“ DILLA KIOS PASIR PANJANG</option>
<option>E004 â€“ EMMI TAN BU</option>
<option>H040 â€“ HENDRO KOLAM AIR BESAR</option>
<option>I042 â€“ IBU HASNI NASKUN</option>
<option>J012 â€“ JOKO MAS</option>
<option>K018 â€“ KODAR MAS</option>
<option>K055 â€“ KIOS IRMA</option>
<option>M085 â€“ MAULANA KIOS</option>
<option>N003 â€“ NANDO</option>
<option>P032 â€“ PUTRA SOLO</option>
<option>R038 â€“ RS MISI SEBRANG</option>
<option>S050 â€“ SUMBER REJEKI PASIR PANJANG</option>
<option>S076 â€“ SINAR MERAPI</option>
<option>S091 â€“ SINAR MUDA KIOS (EBA)</option>
<option>S092 â€“ KANTIN SMAN 2 (SLAMET)</option>
<option>S111 â€“ SABYAN KIOS</option>
<option>S160 â€“ SIMPANG TIGA KIOS</option>
<option>T002 â€“ ANTO KIOS</option>
<option>Y014 â€“ YULI BAKEKO</option>
<option>F002 â€“ FADJRIN</option>
<option>R024 â€“ ROMAIKA KIOS</option>
<option>S037 â€“ SOKIMIN SEBRANG</option>
<option>D010 â€“ DICKY SEBRANG</option>
<option>A111 â€“ ALKA KIOS</option>
<option>B064 â€“ BEACHES CAFE</option>
</select>

<label>Nama Produk</label>
<input type="text" id="produk">

<label>Jumlah</label>
<input type="number" id="qty">

<label>Harga Satuan</label>
<input type="number" id="harga">

<button onclick="tambah()">âž• Simpan Order</button>

</div>

<div class="box">
<button onclick="exportExcel()">â¬‡ Export ke Excel</button>

<table id="tabel">
<tr>
<th>Tanggal</th>
<th>Outlet</th>
<th>Produk</th>
<th>Qty</th>
<th>Harga</th>
<th>Total</th>
</tr>
</table>
</div>

<script>
let data = JSON.parse(localStorage.getItem("order")) || [];

function render() {
    const tabel = document.getElementById("tabel");
    tabel.innerHTML = `
    <tr>
        <th>Tanggal</th>
        <th>Outlet</th>
        <th>Produk</th>
        <th>Qty</th>
        <th>Harga</th>
        <th>Total</th>
    </tr>`;
    data.forEach(d => {
        tabel.innerHTML += `
        <tr>
            <td>${d.tanggal}</td>
            <td>${d.outlet}</td>
            <td>${d.produk}</td>
            <td>${d.qty}</td>
            <td>${d.harga}</td>
            <td>${d.total}</td>
        </tr>`;
    });
}

function tambah() {
    const tgl = tanggal.value;
    const outlet = document.getElementById("outlet").value;
    const produk = document.getElementById("produk").value;
    const qty = Number(document.getElementById("qty").value);
    const harga = Number(document.getElementById("harga").value);

    if (!tgl || !outlet || !produk) {
        alert("Lengkapi data");
        return;
    }

    const total = qty * harga;

    data.push({ tanggal: tgl, outlet, produk, qty, harga, total });
    localStorage.setItem("order", JSON.stringify(data));
    render();

    produk.value = "";
    qty.value = "";
    harga.value = "";
}

function exportExcel() {
    let csv = "Tanggal,Outlet,Produk,Qty,Harga,Total\n";
    data.forEach(d => {
        csv += `${d.tanggal},${d.outlet},${d.produk},${d.qty},${d.harga},${d.total}\n`;
    });

    const blob = new Blob([csv], { type: "text/csv" });
    const url = URL.createObjectURL(blob);

    const a = document.createElement("a");
    a.href = url;
    a.download = "order-outlet.csv";
    a.click();
}

render();
</script>

</body>
</html>
