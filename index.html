<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Sales Order Pro ‚Äì Rute</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
*{box-sizing:border-box}
body{
font-family:-apple-system,BlinkMacSystemFont,Arial;
margin:0;
background:#f4f6f9;
}

.hidden{display:none}

header{
background:linear-gradient(135deg,#0f172a,#1e3a8a);
color:white;
padding:25px;
border-radius:0 0 25px 25px;
text-align:center;
}

.card{
background:white;
margin:15px;
padding:18px;
border-radius:18px;
box-shadow:0 10px 25px rgba(0,0,0,.06);
}

input,select{
width:100%;
padding:12px;
margin-top:6px;
border-radius:12px;
border:1px solid #ddd;
font-size:15px;
}

button{
width:100%;
padding:14px;
border-radius:14px;
border:none;
font-size:16px;
margin-top:12px;
color:white;
background:#2563eb;
}

.btn2{background:#059669}
.btn3{background:#25D366}
.btnDel{background:#ef4444;padding:6px 10px;font-size:12px}

table{
width:100%;
border-collapse:collapse;
margin-top:10px;
font-size:13px;
}

th,td{
padding:8px;
border-bottom:1px solid #eee;
}

th{background:#f1f5f9}

.totalBox{
background:#0f172a;
color:white;
padding:15px;
border-radius:15px;
margin-top:15px;
text-align:center;
font-size:18px;
}

.visited{
background:#dcfce7;
color:#065f46;
font-weight:600;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login" class="card">
<h2>üîê Login Sales</h2>
<input id="sales" placeholder="Nama Sales">
<button onclick="login()">Masuk</button>
</div>

<!-- APP -->
<div id="app" class="hidden">

<header>
<h2>üì¶ SALES ORDER PRO</h2>
<div id="salesName"></div>
</header>

<div class="card">
<input type="date" id="tgl">

<select id="outlet"></select>

<input id="produk" placeholder="Nama Produk">
<input id="qty" type="number" placeholder="Qty">
<input id="harga" type="number" placeholder="Harga">

<button onclick="tambah()">‚ûï Simpan Order</button>
</div>

<div class="card">
<button class="btn2" onclick="exportExcel()">‚¨á Export Excel</button>
<button class="btn3" onclick="kirimWA()">üì≤ Kirim WhatsApp</button>

<table id="tbl"></table>

<div class="totalBox" id="totalHari"></div>
</div>

</div>

<script>
const outletList = [
"A088 ‚Äì AMELIA BAKEKO","A095 ‚Äì AMOR KIOS","A120 ‚Äì AGORA TIMUR NUSANTARA",
"A124 ‚Äì AZIZAH KIOS","A129 ‚Äì APRI KIOS SEBRANG","D029 ‚Äì DILA KIOS",
"D044 ‚Äì DILLA KIOS PASIR PANJANG","E004 ‚Äì EMMI TAN BU",
"H040 ‚Äì HENDRO KOLAM AIR BESAR","I042 ‚Äì IBU HASNI NASKUN",
"J012 ‚Äì JOKO MAS","K018 ‚Äì KODAR MAS","K055 ‚Äì KIOS IRMA",
"M085 ‚Äì MAULANA KIOS","N003 ‚Äì NANDO","P032 ‚Äì PUTRA SOLO",
"R038 ‚Äì RS MISI SEBRANG","S050 ‚Äì SUMBER REJEKI PASIR PANJANG",
"S076 ‚Äì SINAR MERAPI","S091 ‚Äì SINAR MUDA KIOS (EBA)",
"S092 ‚Äì KANTIN SMAN 2 (SLAMET)","S111 ‚Äì SABYAN KIOS",
"S160 ‚Äì SIMPANG TIGA KIOS","T002 ‚Äì ANTO KIOS","Y014 ‚Äì YULI BAKEKO",
"F002 ‚Äì FADJRIN","R024 ‚Äì ROMAIKA KIOS","S037 ‚Äì SOKIMIN SEBRANG",
"D010 ‚Äì DICKY SEBRANG","A111 ‚Äì ALKA KIOS","B064 ‚Äì BEACHES CAFE"
];

let orders = JSON.parse(localStorage.getItem("orders")) || [];
let salesName = localStorage.getItem("sales");

if(salesName){
login.classList.add("hidden");
app.classList.remove("hidden");
document.getElementById("salesName").innerText="Sales: "+salesName;
}

function login(){
const s=sales.value.trim();
if(!s) return alert("Isi nama sales");
localStorage.setItem("sales",s);
location.reload();
}

function loadOutlet(){
const t=tgl.value;
outlet.innerHTML='<option value="">Pilih Outlet</option>';

outletList.forEach(o=>{
const opt=document.createElement("option");
opt.value=o;
opt.textContent=o;

const sudah=orders.some(x=>x.tgl===t && x.outlet===o);

if(sudah){
opt.textContent+=" ‚úì SUDAH DIKUNJUNGI";
opt.classList.add("visited");
}
outlet.appendChild(opt);
});
}

function tambah(){
if(!tgl.value || !outlet.value) return alert("Lengkapi data");

const o={
tgl:tgl.value,
outlet:outlet.value,
produk:produk.value,
qty:+qty.value,
harga:+harga.value
};
o.total=o.qty*o.harga;

orders.push(o);
localStorage.setItem("orders",JSON.stringify(orders));

produk.value="";qty.value="";harga.value="";
loadOutlet();
render();
}

function render(){
let html=`<tr>
<th>Tanggal</th><th>Outlet</th><th>Produk</th>
<th>Qty</th><th>Total</th><th></th></tr>`;
let total=0;

orders.forEach((o,i)=>{
html+=`<tr>
<td>${o.tgl}</td>
<td>${o.outlet}</td>
<td>${o.produk}</td>
<td>${o.qty}</td>
<td>${o.total}</td>
<td><button class="btnDel" onclick="del(${i})">X</button></td>
</tr>`;
total+=o.total;
});

tbl.innerHTML=html;
totalHari.innerText="TOTAL SEMUA : Rp "+total.toLocaleString("id-ID");
}

function del(i){
if(confirm("Hapus order ini?")){
orders.splice(i,1);
localStorage.setItem("orders",JSON.stringify(orders));
render();
loadOutlet();
}
}

function exportExcel(){
let csv="Tanggal,Outlet,Produk,Qty,Harga,Total\n";
orders.forEach(o=>{
csv+=`${o.tgl},${o.outlet},${o.produk},${o.qty},${o.harga},${o.total}\n`;
});
let a=document.createElement("a");
a.href=URL.createObjectURL(new Blob([csv]));
a.download="laporan-sales.csv";
a.click();
}

function kirimWA(){
let t="*LAPORAN SALES*%0A";
let total=0;
orders.forEach(o=>{
t+=`${o.tgl} - ${o.outlet}%0A${o.produk} x${o.qty} = ${o.total}%0A%0A`;
total+=o.total;
});
t+=`TOTAL : ${total}`;
window.open("https://wa.me/?text="+t);
}

tgl.addEventListener("change",loadOutlet);
loadOutlet();
render();
</script>

</body>
</html>
